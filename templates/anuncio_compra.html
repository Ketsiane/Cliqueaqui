{% extends "estrutura.html" %}

{% block content %}
    <h2>{{ titulo }}</h2>
    
    <h3>Nova Compra</h3>
    <form action="{{ url_for('nova_compra') }}" method="post">
        <label for="quantidade">Quantidade:</label>
        <input type="number" id="quantidade" name="quantidade" required>
        <br>
        <label for="preco">Preço:</label>
        <input type="number" id="preco" name="preco" step="0.01" required>
        <br>
        <label for="anu_id">Anúncio:</label>
        <select id="anu_id" name="anu_id" required>
            {% for anuncio in anuncios %}
                <option value="{{ anuncio.id }}">{{ anuncio.nome }}</option>
            {% endfor %}
        </select>
        <br>
        <label for="usu_id">Usuário:</label>
        <select id="usu_id" name="usu_id" required>
            {% for usuario in usuarios %}
                <option value="{{ usuario.id }}">{{ usuario.nome }}</option>
            {% endfor %}
        </select>
        <br>
        <button type="submit">Comprar</button>
    </form>
    
    <h3>Lista de Compras</h3>
    <table border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Quantidade</th>
                <th>Preço</th>
                <th>Total</th>
                <th>Anúncio</th>
                <th>Usuário</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for compra in compras %}
            <tr>
                <td>{{ compra.id }}</td>
                <td>{{ compra.quantidade }}</td>
                <td>{{ compra.preco }}</td>
                <td>{{ compra.total }}</td>
                <td>{{ compra.anu_id }}</td>
                <td>{{ compra.usu_id }}</td>
                <td>
                    <a href="{{ url_for('editar_compra', id=compra.id) }}">Editar</a> |
                    <a href="{{ url_for('excluir_compra', id=compra.id) }}" onclick="return confirm('Deseja realmente excluir esta compra?');">Excluir</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <br>
    <a href="{{ url_for('index') }}">Voltar para o Início</a>
{% endblock %}